# Hash Cracking (`john`, `hashcat`)

## Common Use

```bash
john --format=[format] --wordlist=/usr/share/wordlists/rockyou.txt [password_file]
... (let it run)
john --show --format=[format] [password_file]
```

## CC: Pen Test - Hash Cracking

Most files with hashes in them either have each hash on a new line or hashes followed by their salt (`hash:salt`)

- Some algs/formats salt before and some salt after, research is good here

## Hashcat

- Renowned for versatility and speed
- No autodetection, but has modes you set ([link to modes here](https://hashcat.net/wiki/doku.php?id=example_hashes))
- Hashcat doesn't work for me...it can't run on a vm apparently (or at least not well)

## John the Ripper

- Supports a lot of formats and is very easy to use with a lot of customization options
- Probably not as fast as Hashcat, but it works on my VM, so eat that, losers...

While the normal `wordlist` mode is mostly used, there's also a `single` crack mode which builds off of variations of a username or other identifying info found using word mangling. John can use either a provided name or use the format found in `etc/passwd` known as Gecos. For `single` mode, make sure to change the hash to the `user:hash` format

You can also make custom rules in the `/etc/john/john.conf` config file. They have a [wiki page](https://www.openwall.com/john/doc/RULES.shtml) going over some of the syntax. You can then call the custom rules using `--rule=Name`. The following is directly from the John the Ripper THM room

```
The first line:
[List.Rules:THMRules] - Is used to define the name of your rule, this is what you will use to call your custom rule as a John argument.

We then use a regex style pattern match to define where in the word will be modified, again- we will only cover the basic and most common modifiers here:
Az - Takes the word and appends it with the characters you define
A0 - Takes the word and prepends it with the characters you define
c - Capitalises the character positionally

These can be used in combination to define where and what in the word you want to modify.

Lastly, we then need to define what characters should be appended, prepended or otherwise included, we do this by adding character sets in square brackets [ ] in the order they should be used. These directly follow the modifier patterns inside of double quotes " ". Here are some common examples:
[0-9] - Will include numbers 0-9
[0] - Will include only the number 0
[A-z] - Will include both upper and lowercase
[A-Z] - Will include only uppercase letters
[a-z] - Will include only lowercase letters
[a] - Will include only a
[!£$%@] - Will include the symbols !£$%@

Putting this all together, in order to generate a wordlist from the rules that would match the example password "Polopassword1!" (assuming the word polopassword was in our wordlist) we would create a rule entry that looks like this:

[List.Rules:PoloPassword]
cAz"[0-9] [!£$%@]"

In order to:
Capitalise the first  letter - c
Append to the end of the word - Az
A number in the range 0-9 - [0-9]
Followed by a symbol that is one of [!£$%@]
```

John can crack more than just pure hashes. John includes other utilities as well. Some can be found as bins in `/usr/sbin` while others are python scripts which live in `/usr/share/john`

## Name That Hash (`nth`)

Tool that can help suggest what kind of hash something is. Probably shouldn't be a verbatim answer but can be used as a start or suggestion
